<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
<style>
    #main{
        margin:50px 50px;
        width: 500px;
        height: 300px;
        overflow: hidden;
        background: aqua;
        position: relative;
    }
    .content{
		/* transition:0.3s; */
        position: absolute;
        left: 0;
        top: 0;
        list-style: none;
        padding: 0;
        margin: 0;
    }
    .content li{
        border: 2px solid red;
        margin-bottom: 20px;
        background: white;
        box-sizing: border-box;
        width: 100%;
        height: 200px;
    }
    .right{
        list-style: none;
        margin: 0;
        padding: 0;
    position: absolute;
    right: 0;
    top: 0;
    width: 18px;
    height: 300px;
    /* background: red; */
}
.ico{
    width: 100%;
    height: 18px;
    background: black;
}
.scrollArea{
    position: relative;
    width: 100%;
    height: 264px;
    /* height: 464px; */
    background: #fff;
}
.bar{
    position: absolute;
    top: 0;
    /* left: 0; */
    width: 100%;
    background: #00456b; 
}


#main2{
    position: absolute;
    right: 0;
    top: 0;
    width: 20px;
    background: pink;
    height: 100%;
}


.aaa{
	width: 200px;
	height: 50px;
	font-weight: bold;
    color: #00BEFF;
    background: linear-gradient(180deg,rgba(105,207,248,0.3) 0%,rgba(56,161,238,0) 100%);
    background: -o-linear-gradient(top,rgba(105,207,248,0.3) 0%,rgba(56,161,238,0) 100%) ;
    background: -moz-linear-gradient(top,rgba(105,207,248,0.3) 0%,rgba(56,161,238,0) 100%) ;
	background: -webkit-linear-gradient(top,rgba(105,207,248,0.3) 0%,rgba(56,161,238,0) 100%);
    border-radius: 36px;
}
</style>    
</head>
<body>
 
        <div id="main">
            <ul class="content">
                <li>
                    345345
                </li>
                <li>
                    34534
                </li>
                <li>
                    3453
                </li>
                <li>
                    56
                </li>
                <li>
                    5671123
                </li>
            </ul>

			


			<!-- <div class="aaa">3242fsdvjnsdh</div> -->
            <!-- <ul class="right">
                <li class="ico up"></li>
                <li class="scrollArea">
                    <div class="bar"></div>
                </li>
                <li class="ico down"></li>
            </ul> -->
        </div>
      

</body>
</html>
<script src="./index.js">
    
</script>
<script>
    var main = document.querySelector("#main");
    // mScroll({
   	// 		el:main,
   	// 		back:0
    // });
        v2Scroll({
            el:main,
        })


    var Tween = {
	linear: function (t, b, c, d){
		return c*t/d + b;
	},
	easeIn: function(t, b, c, d){
		return c*(t/=d)*t + b;
	},
	easeOut: function(t, b, c, d){
		return -c *(t/=d)*(t-2) + b;
	},
	easeBoth: function(t, b, c, d){
		if ((t/=d/2) < 1) {
			return c/2*t*t + b;
		}
		return -c/2 * ((--t)*(t-2) - 1) + b;
	},
	easeInStrong: function(t, b, c, d){
		return c*(t/=d)*t*t*t + b;
	},
	easeOutStrong: function(t, b, c, d){
		return -c * ((t=t/d-1)*t*t*t - 1) + b;
	},
	easeBothStrong: function(t, b, c, d){
		if ((t/=d/2) < 1) {
			return c/2*t*t*t*t + b;
		}
		return -c/2 * ((t-=2)*t*t*t - 2) + b;
	},
	elasticIn: function(t, b, c, d, a, p){
		if (t === 0) { 
			return b; 
		}
		if ( (t /= d) == 1 ) {
			return b+c; 
		}
		if (!p) {
			p=d*0.3; 
		}
		if (!a || a < Math.abs(c)) {
			a = c; 
			var s = p/4;
		} else {
			var s = p/(2*Math.PI) * Math.asin (c/a);
		}
		return -(a*Math.pow(2,10*(t-=1)) * Math.sin( (t*d-s)*(2*Math.PI)/p )) + b;
	},
	elasticOut: function(t, b, c, d, a, p){
		if (t === 0) {
			return b;
		}
		if ( (t /= d) == 1 ) {
			return b+c;
		}
		if (!p) {
			p=d*0.3;
		}
		if (!a || a < Math.abs(c)) {
			a = c;
			var s = p / 4;
		} else {
			var s = p/(2*Math.PI) * Math.asin (c/a);
		}
		return a*Math.pow(2,-10*t) * Math.sin( (t*d-s)*(2*Math.PI)/p ) + c + b;
	},    
	elasticBoth: function(t, b, c, d, a, p){
		if (t === 0) {
			return b;
		}
		if ( (t /= d/2) == 2 ) {
			return b+c;
		}
		if (!p) {
			p = d*(0.3*1.5);
		}
		if ( !a || a < Math.abs(c) ) {
			a = c; 
			var s = p/4;
		}
		else {
			var s = p/(2*Math.PI) * Math.asin (c/a);
		}
		if (t < 1) {
			return - 0.5*(a*Math.pow(2,10*(t-=1)) * 
					Math.sin( (t*d-s)*(2*Math.PI)/p )) + b;
		}
		return a*Math.pow(2,-10*(t-=1)) * 
				Math.sin( (t*d-s)*(2*Math.PI)/p )*0.5 + c + b;
	},
	backIn: function(t, b, c, d, s){
		if (typeof s == 'undefined') {
		   s = 1.70158;
		}
		return c*(t/=d)*t*((s+1)*t - s) + b;
	},
	backOut: function(t, b, c, d, s){
		if (typeof s == 'undefined') {
			s = 2.70158;  //回缩的距离
		}
		return c*((t=t/d-1)*t*((s+1)*t + s) + 1) + b;
	}, 
	backBoth: function(t, b, c, d, s){
		if (typeof s == 'undefined') {
			s = 1.70158; 
		}
		if ((t /= d/2 ) < 1) {
			return c/2*(t*t*(((s*=(1.525))+1)*t - s)) + b;
		}
		return c/2*((t-=2)*t*(((s*=(1.525))+1)*t + s) + 2) + b;
	},
	bounceIn: function(t, b, c, d){
		return c - Tween['bounceOut'](d-t, 0, c, d) + b;
	},       
	bounceOut: function(t, b, c, d){
		if ((t/=d) < (1/2.75)) {
			return c*(7.5625*t*t) + b;
		} else if (t < (2/2.75)) {
			return c*(7.5625*(t-=(1.5/2.75))*t + 0.75) + b;
		} else if (t < (2.5/2.75)) {
			return c*(7.5625*(t-=(2.25/2.75))*t + 0.9375) + b;
		}
		return c*(7.5625*(t-=(2.625/2.75))*t + 0.984375) + b;
	},      
	bounceBoth: function(t, b, c, d){
		if (t < d/2) {
			return Tween['bounceIn'](t*2, 0, c, d) * 0.5 + b;
		}
		return Tween['bounceOut'](t*2-d, 0, c, d) * 0.5 + c*0.5 + b;
	}
};
function css(element, attr , val){
	if(attr == "scale"||attr == "scaleX"
	||attr == "scaleY"||attr == "scaleZ"
	||attr == "rotateX"||attr == "rotateY"
	||attr == "rotateZ"||attr == "rotate"
	||attr == "skewX"||attr == "skewY"
	||attr == "translateX"||attr == "translateY"
	||attr == "translateZ") {
		return cssTransform(element, attr, val);
	}
	if(arguments.length == 2){
		var val = getComputedStyle(element)[attr];
		if(attr=='opacity'){
			val = Math.round(val*100);
		}
		return parseFloat(val);
	} 
	if(attr == "opacity") {
		element.style.opacity= val/100;
	} else {
		element.style[attr]= val + "px";	
	}
}
function cssTransform(element, attr, val){
	if(!element.transform){
		element.transform = {};
	}	
	if(typeof val === "undefined"){ 
		if(typeof element.transform[attr] === "undefined"){
			switch(attr){
				case "scale":
				case "scaleX":
				case "scaleY":
				case "scaleZ":
					element.transform[attr] = 100;
					break;
				default:
					element.transform[attr] = 0;	
			}
		} 
		return element.transform[attr];
	} else {
		element.transform[attr] = val;
		var transformVal  = "";
		for(var s in element.transform){
			switch(s){
				case "scale":
				case "scaleX":
				case "scaleY":
				case "scaleZ":
					transformVal += " " + s + "("+(element.transform[s]/100)+")";
					break;
				case "rotate":
				case "rotateX":
				case "rotateY":
				case "rotateZ":
				case "skewX":
				case "skewY":
					transformVal += " " + s + "("+element.transform[s]+"deg)";
					break;
				default:
					transformVal += " " + s + "("+element.transform[s]+"px)";				
			}
		}
		element.style.WebkitTransform = element.style.transform = transformVal;
	}
}
function MTween(init){
	var t = 0;
	var b = {};
	var c = {};
	var d = init.time / 20;
	for(var s in init.target){ 
		b[s] = css(init.el, s); 
		c[s] = init.target[s] - b[s];
	}
	clearInterval(init.el.timer); 
	init.el.timer = setInterval(
		function(){
			t++;
			if(t>d){
				clearInterval(init.el.timer);
				init.callBack&&init.callBack.call(init.el);
			} else {
				init.callIn&&init.callIn.call(init.el);
				for(var s in b){
					var val = Number((Tween[init.type](t,b[s],c[s],d)).toFixed(2));
					css(init.el, s, val);
				}
			}
		},
		20
	);
}
function mScroll(init){
	if(!init.el){
		return;
	}
	var wrap = init.el;
	var inner = init.el.children[0];
    var scrollBar = document.createElement("div");	
	var startPoint = 0;
	var startEl = 0;
	var lastY = 0;
	var lastDis = 0;
	var lastTime = 0;
	var lastTimeDis = 0;
	var back=init.back;
	// var back = document.documentElement.clientWidth/8;//除以16是1rem。
	var maxTranslate = wrap.clientHeight - inner.offsetHeight;
	scrollBar.id = "scrollBar";
	
    var scale = wrap.clientHeight/inner.offsetHeight;
    inner.style.minHeight = "100%";
    scrollBar.style.cssText = "height:50px;width:20px;background:rgba(0,0,0,.5);position:absolute;right:0;top:0;border-radius:2px;";
    wrap.appendChild(scrollBar);

    css(inner,"translateZ",0.01);
    
    scrollBar.style.height = wrap.clientHeight * scale + "px";
    if(maxTranslate >= 0) {
        scrollBar.style.display = "none";
    } else {
        scrollBar.style.display = "block";
    }

    scrollBar.onmousedown = function(ev) {
        var startPoint=ev.pageY-wrap.offsetTop;
        console.log(startPoint)
        document.onmouseover= function(ev){
            window.getSelection ? window.getSelection().removeAllRanges() : document.selection.empty()
            var off= ev.pageY-startPoint-wrap.offsetTop;
            if(off<0){
                off=0;
            }
            scrollBar.style.top=off+"px";
        }
        document.onmouseup=function(){
            document.onmouseover=null;
            document.onmouseover=null;

        }
    }
   




	// inner.addEventListener('touchstart', function(e) {
	// 	maxTranslate = wrap.clientHeight - inner.offsetHeight;
	// 	if(!init.offBar){
	// 		if(maxTranslate >= 0) {
	// 			// scrollBar.style.display = "none";
	// 		} else {
	// 			scrollBar.style.display = "block";
	// 		}
	// 		scale = wrap.clientHeight/inner.offsetHeight;
	// 		scrollBar.style.height = wrap.clientHeight * scale + "px";
	// 	}
	// 	clearInterval(inner.timer);
	// 	startPoint = e.changedTouches[0].pageY;
	// 	startEl = css(inner,"translateY");
	// 	lastY = startEl;
	// 	lastTime = new Date().getTime();
	// 	lastTimeDis = lastDis = 0;
	// 	(init.offBar)||(scrollBar.style.opacity = 1);
	// 	init.start&&init.start.call(main,e);
	// });
	// inner.addEventListener('touchmove', function(e) {
	// 	var nowTime = new Date().getTime();
	// 	var nowPoint = e.changedTouches[0].pageY;
	// 	var dis = nowPoint - startPoint;
	// 	var translateY = startEl + dis;
	// 	if (translateY<wrap.clientHeight - inner.offsetHeight-back) {
	// 		translateY=wrap.clientHeight - inner.offsetHeight-back;
	// 	}
	// 	if (translateY>back) {
	// 		translateY=back;
	// 	}
	// 	css(inner,"translateY",translateY);
	// 	(init.offBar)||css(scrollBar,"translateY",-translateY*scale);
	// 	lastDis = translateY - lastY;
	// 	lastY = translateY;
	// 	lastTimeDis = nowTime - lastTime;
	// 	lastTime = nowTime;
	// 	init.move&&init.move.call(main,e);
	// });
	// inner.addEventListener('touchend', function(e) {
	// 	var type = "easeOut";
	// 	var speed = Math.round(lastDis / lastTimeDis*10);
	// 	speed = lastTimeDis <= 0?0 :speed;
	// 	var target = Math.round(speed*30 + css(inner,"translateY"));
	// 	if(target > 0){
	// 		target = 0;
	// 		type = "backOut";
	// 	} else if(target < maxTranslate){
	// 		target = maxTranslate;
	// 		type = "backOut";
	// 	}
	// 	MTween({
	// 		el:inner,
	// 		target: {translateY:target},
	// 		time: Math.round(Math.abs(target - css(inner,"translateY"))*1.8),
	// 		type: type,
	// 		callBack: function(){
	// 			(init.offBar) || (scrollBar.style.opacity = 0);
	// 			init.over&&init.over.call(main,e);
	// 		},
	// 		callIn: function(){
	// 			var translateY = css(inner,"translateY");
	// 			init.offBar||css(scrollBar,"translateY",-translateY*scale);
	// 			init.move&&init.move.call(main,e);
	// 		}
	// 	});
	// 	init.end&&init.end.call(main,e);
	// });
}
</script>